(()=>{var e,t={438:e=>{(()=>{"use strict";var t={d:(e,a)=>{for(var r in a)t.o(a,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},a={};t.r(a),t.d(a,{default:()=>r});const r=function(e){var t=e.condition,a=e.show,r=e.elseShow,n=function(e){return"function"==typeof e},s=function(e){return e()||(console.warn("Nothing was returned from your render function. Please make sure you are returning a valid React element."),null)};return t?n(a)?s(a):a:!t&&r?n(r)?s(r):r:null};e.exports=a})()},548:(e,t,a)=>{(()=>{"use strict";var t={n:e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var r in a)t.o(a,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};t.r(r),t.d(r,{Chatbot:()=>B,createChatBotMessage:()=>u,createClientMessage:()=>m,createCustomMessage:()=>d,default:()=>H,useChatbot:()=>N});const n=a(609);var s=t.n(n);const o=a(438);var i=t.n(o),c=function(){return c=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},c.apply(this,arguments)},l=function(e,t){return{message:e,type:t,id:Math.round(Date.now()*Math.random())}},u=function(e,t){return c(c(c({},l(e,"bot")),t),{loading:!0})},d=function(e,t,a){return c(c({},l(e,t)),a)},m=function(e,t){return c(c({},l(e,"user")),t)},h=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(e)return e.apply(void 0,t)};function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},g.apply(this,arguments)}const p=({styles:e={},...t})=>s().createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t),s().createElement("path",{d:"M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z"})),f=function(e){var t=e.message,a=e.customComponents;return s().createElement("div",{className:"react-chatbot-kit-user-chat-message-container"},s().createElement(i(),{condition:!!a.userChatMessage,show:h(a.userChatMessage,{message:t}),elseShow:s().createElement("div",{className:"react-chatbot-kit-user-chat-message"},t,s().createElement("div",{className:"react-chatbot-kit-user-chat-message-arrow"}))}),s().createElement(i(),{condition:!!a.userAvatar,show:h(a.userAvatar),elseShow:s().createElement("div",{className:"react-chatbot-kit-user-avatar"},s().createElement("div",{className:"react-chatbot-kit-user-avatar-container"},s().createElement(p,{className:"react-chatbot-kit-user-avatar-icon"})))}))},v=function(){return s().createElement("div",{className:"react-chatbot-kit-chat-bot-avatar"},s().createElement("div",{className:"react-chatbot-kit-chat-bot-avatar-container"},s().createElement("p",{className:"react-chatbot-kit-chat-bot-avatar-letter"},"B")))},y=function(){return s().createElement("div",{className:"chatbot-loader-container"},s().createElement("svg",{id:"dots",width:"50px",height:"21px",viewBox:"0 0 132 58",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},s().createElement("g",{stroke:"none",fill:"none"},s().createElement("g",{id:"chatbot-loader",fill:"#fff"},s().createElement("circle",{id:"chatbot-loader-dot1",cx:"25",cy:"30",r:"13"}),s().createElement("circle",{id:"chatbot-loader-dot2",cx:"65",cy:"30",r:"13"}),s().createElement("circle",{id:"chatbot-loader-dot3",cx:"105",cy:"30",r:"13"})))))};var b=function(){return b=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},b.apply(this,arguments)};const w=function(e){var t=e.message,a=e.withAvatar,r=void 0===a||a,o=e.loading,c=e.messages,l=e.customComponents,u=e.setState,d=e.customStyles,m=e.delay,g=e.id,p=(0,n.useState)(!1),f=p[0],w=p[1];(0,n.useEffect)((function(){var e;return function(t,a){var r=750;m&&(r+=m),e=setTimeout((function(){var e=function(e,t,a){if(a||2===arguments.length)for(var r,n=0,s=t.length;n<s;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}([],t,!0).find((function(e){return e.id===g}));e&&(e.loading=!1,e.delay=void 0,a((function(t){var a=t.messages,r=a.findIndex((function(e){return e.id===g}));return a[r]=e,b(b({},t),{messages:a})})))}),r)}(c,u),function(){clearTimeout(e)}}),[m,g]),(0,n.useEffect)((function(){m?setTimeout((function(){return w(!0)}),m):w(!0)}),[m]);var E={backgroundColor:""},S={borderRightColor:""};return d&&(E.backgroundColor=d.backgroundColor,S.borderRightColor=d.backgroundColor),s().createElement(i(),{condition:f,show:s().createElement("div",{className:"react-chatbot-kit-chat-bot-message-container"},s().createElement(i(),{condition:r,show:s().createElement(i(),{condition:!!(null==l?void 0:l.botAvatar),show:h(null==l?void 0:l.botAvatar),elseShow:s().createElement(v,null)})}),s().createElement(i(),{condition:!!(null==l?void 0:l.botChatMessage),show:h(null==l?void 0:l.botChatMessage,{message:t,loader:s().createElement(y,null)}),elseShow:s().createElement("div",{className:"react-chatbot-kit-chat-bot-message",style:E},s().createElement(i(),{condition:o,show:s().createElement(y,null),elseShow:s().createElement("span",null,t)}),s().createElement(i(),{condition:r,show:s().createElement("div",{className:"react-chatbot-kit-chat-bot-message-arrow",style:S})}))}))})};function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},E.apply(this,arguments)}const S=({styles:e={},...t})=>s().createElement("svg",E({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t),s().createElement("path",{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"}));var P=function(){return P=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},P.apply(this,arguments)},M=function(e,t,a){if(a||2===arguments.length)for(var r,n=0,s=t.length;n<s;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))};const C=function(e){var t=e.state,a=e.setState,r=e.widgetRegistry,o=e.messageParser,c=e.parse,u=e.customComponents,d=e.actionProvider,m=e.botName,h=e.customStyles,g=e.headerText,p=e.customMessages,v=e.placeholderText,y=e.validator,b=e.disableScrollToBottom,E=e.messageHistory,C=e.actions,O=e.messageContainerRef,k=t.messages,x=(0,n.useState)(""),j=x[0],I=x[1],A=function(){setTimeout((function(){var e;O.current&&(O.current.scrollTop=null===(e=null==O?void 0:O.current)||void 0===e?void 0:e.scrollHeight)}),50)};(0,n.useEffect)((function(){b||A()}));var T=function(){a((function(e){return P(P({},e),{messages:M(M([],e.messages,!0),[l(j,"user")],!1)})})),A(),I("")},N={backgroundColor:""};h&&h.chatButton&&(N.backgroundColor=h.chatButton.backgroundColor);var _="Conversation with "+m;g&&(_=g);var B="Write your message here";return v&&(B=v),s().createElement("div",{className:"react-chatbot-kit-chat-container"},s().createElement("div",{className:"react-chatbot-kit-chat-inner-container"},s().createElement(i(),{condition:!!u.header,show:u.header&&u.header(d),elseShow:s().createElement("div",{className:"react-chatbot-kit-chat-header"},_)}),s().createElement("div",{className:"react-chatbot-kit-chat-message-container",ref:O},s().createElement(i(),{condition:"string"==typeof E&&Boolean(E),show:s().createElement("div",{dangerouslySetInnerHTML:{__html:E}})}),k.map((function(e,n){return"bot"===e.type?s().createElement(s().Fragment,{key:e.id},function(e,n){var o;o=e.withAvatar?e.withAvatar:function(e,t){if(0===t)return!0;var a=e[t-1];return!("bot"===a.type&&!a.widget)}(k,n);var c=P(P({},e),{setState:a,state:t,customComponents:u,widgetRegistry:r,messages:k,actions:C});if(e.widget){var l=r.getWidget(c.widget,P(P({},t),{scrollIntoView:A,payload:e.payload,actions:C}));return s().createElement(s().Fragment,null,s().createElement(w,P({customStyles:h.botMessageBox,withAvatar:o},c,{key:e.id})),s().createElement(i(),{condition:!c.loading,show:l||null}))}return s().createElement(w,P({customStyles:h.botMessageBox,key:e.id,withAvatar:o},c,{customComponents:u,messages:k,setState:a}))}(e,n)):"user"===e.type?s().createElement(s().Fragment,{key:e.id},function(e){var a=r.getWidget(e.widget,P(P({},t),{scrollIntoView:A,payload:e.payload,actions:C}));return s().createElement(s().Fragment,null,s().createElement(f,{message:e.message,key:e.id,customComponents:u}),a||null)}(e)):function(e,t){return!!t[e.type]}(e,p)?s().createElement(s().Fragment,{key:e.id},function(e){var n=p[e.type],o={setState:a,state:t,scrollIntoView:A,actionProvider:d,payload:e.payload,actions:C};if(e.widget){var i=r.getWidget(e.widget,P(P({},t),{scrollIntoView:A,payload:e.payload,actions:C}));return s().createElement(s().Fragment,null,n(o),i||null)}return n(o)}(e)):void 0})),s().createElement("div",{style:{paddingBottom:"15px"}})),s().createElement("div",{className:"react-chatbot-kit-chat-input-container"},s().createElement("form",{className:"react-chatbot-kit-chat-input-form",onSubmit:function(e){if(e.preventDefault(),y&&"function"==typeof y){if(y(j)){if(T(),c)return c(j);o.parse(j)}}else{if(T(),c)return c(j);o.parse(j)}}},s().createElement("input",{className:"react-chatbot-kit-chat-input",placeholder:B,value:j,onChange:function(e){return I(e.target.value)}}),s().createElement("button",{className:"react-chatbot-kit-chat-btn-send",style:N},s().createElement(S,{className:"react-chatbot-kit-chat-btn-send-icon"}))))))},O=function(e){var t=e.message;return s().createElement("div",{className:"react-chatbot-kit-error"},s().createElement("h1",{className:"react-chatbot-kit-error-header"},"Ooops. Something is missing."),s().createElement("div",{className:"react-chatbot-kit-error-container"},s().createElement(w,{message:t,withAvatar:!0,loading:!1,id:1,customStyles:{backgroundColor:""},messages:[]})),s().createElement("a",{href:"https://fredrikoseberg.github.io/react-chatbot-kit-docs/",rel:"noopener norefferer",target:"_blank",className:"react-chatbot-kit-error-docs"},"View the docs"))};var k=function(e){return e.widgets?e.widgets:[]},x=function(e){try{new e}catch(e){return!1}return!0},j=function(){return j=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},j.apply(this,arguments)};const I=function(e,t){var a=this;this.addWidget=function(e,t){var r=e.widgetName,n=e.widgetFunc,s=e.mapStateToProps,o=e.props;a[r]={widget:n,props:o,mapStateToProps:s,parentProps:j({},t)}},this.getWidget=function(e,t){var r=a[e];if(r){var n,s=j(j(j(j({scrollIntoView:t.scrollIntoView},r.parentProps),"object"==typeof(n=r.props)?n:{}),a.mapStateToProps(r.mapStateToProps,t)),{setState:a.setState,actionProvider:a.actionProvider||t.actions,actions:t.actions,state:t,payload:t.payload});return r.widget(s)||null}},this.mapStateToProps=function(e,t){if(e)return e.reduce((function(e,a){return e[a]=t[a],e}),{})},this.setState=e,this.actionProvider=t};var A=function(){return A=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},A.apply(this,arguments)},T=function(e,t,a){if(a||2===arguments.length)for(var r,n=0,s=t.length;n<s;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))};const N=function(e){var t=e.config,a=e.actionProvider,r=e.messageParser,o=e.messageHistory,i=e.runInitialMessagesWithHistory,c=e.saveMessages,l=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]])}return a}(e,["config","actionProvider","messageParser","messageHistory","runInitialMessagesWithHistory","saveMessages"]),h="",g="";if(!t||!a||!r)return{configurationError:h="I think you forgot to feed me some props. Did you remember to pass a config, a messageparser and an actionprovider?"};var p=function(e){var t=[];return e.initialMessages||t.push("Config must contain property 'initialMessages', and it expects it to be an array of chatbotmessages."),t}(t);if(p.length)return{invalidPropsError:g=p.reduce((function(e,t){return e+t}),"")};var f=function(e){return e.state?e.state:{}}(t);o&&Array.isArray(o)?t.initialMessages=T([],o,!0):"string"==typeof o&&Boolean(o)&&(i||(t.initialMessages=[]));var v,y,b,w=s().useState(A({messages:T([],t.initialMessages,!0)},f)),E=w[0],S=w[1],P=s().useRef(E.messages),M=s().useRef(),C=s().useRef();(0,n.useEffect)((function(){P.current=E.messages})),(0,n.useEffect)((function(){o&&Array.isArray(o)&&S((function(e){return A(A({},e),{messages:o})}))}),[]),(0,n.useEffect)((function(){var e=C.current;return function(){if(c&&"function"==typeof c){var t=e.innerHTML.toString();c(P.current,t)}}}),[]),(0,n.useEffect)((function(){M.current=E}),[E]);var O=a,j=r;return x(O)&&x(j)?(v=new a(u,S,m,M.current,d,l),y=new I(S,v),b=new r(v,M.current),k(t).forEach((function(e){return null==y?void 0:y.addWidget(e,l)}))):(v=a,b=r,y=new I(S,null),k(t).forEach((function(e){return null==y?void 0:y.addWidget(e,l)}))),{widgetRegistry:y,actionProv:v,messagePars:b,configurationError:h,invalidPropsError:g,state:E,setState:S,messageContainerRef:C,ActionProvider:O,MessageParser:j}};var _=function(){return _=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},_.apply(this,arguments)};const B=function(e){var t=e.actionProvider,a=e.messageParser,r=e.config,n=e.headerText,o=e.placeholderText,i=e.saveMessages,c=e.messageHistory,l=e.runInitialMessagesWithHistory,d=e.disableScrollToBottom,m=e.validator,h=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(a[r[n]]=e[r[n]])}return a}(e,["actionProvider","messageParser","config","headerText","placeholderText","saveMessages","messageHistory","runInitialMessagesWithHistory","disableScrollToBottom","validator"]),g=N(_({config:r,actionProvider:t,messageParser:a,messageHistory:c,saveMessages:i,runInitialMessagesWithHistory:l},h)),p=g.configurationError,f=g.invalidPropsError,v=g.ActionProvider,y=g.MessageParser,b=g.widgetRegistry,w=g.messageContainerRef,E=g.actionProv,S=g.messagePars,P=g.state,M=g.setState;if(p)return s().createElement(O,{message:p});if(f.length)return s().createElement(O,{message:f});var k=function(e){return e.customStyles?e.customStyles:{}}(r),j=function(e){return e.customComponents?e.customComponents:{}}(r),I=function(e){return e.botName?e.botName:"Bot"}(r),A=function(e){return e.customMessages?e.customMessages:{}}(r);return x(v)&&x(y)?s().createElement(C,{state:P,setState:M,widgetRegistry:b,actionProvider:E,messageParser:S,customMessages:A,customComponents:_({},j),botName:I,customStyles:_({},k),headerText:n,placeholderText:o,validator:m,messageHistory:c,disableScrollToBottom:d,messageContainerRef:w}):s().createElement(v,{state:P,setState:M,createChatBotMessage:u},s().createElement(y,null,s().createElement(C,{state:P,setState:M,widgetRegistry:b,actionProvider:v,messageParser:y,customMessages:A,customComponents:_({},j),botName:I,customStyles:_({},k),headerText:n,placeholderText:o,validator:m,messageHistory:c,disableScrollToBottom:d,messageContainerRef:w})))},H=B;e.exports=r})()},609:e=>{"use strict";e.exports=window.React},614:(e,t,a)=>{"use strict";var r,n=a(548),s=a(609);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},o.apply(null,arguments)}var i=function(e){return s.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e),r||(r=s.createElement("path",{d:"M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 64.5 112 144s64.5 144 144 144m128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128"})))};const c=window.ReactJSXRuntime,l=()=>(0,c.jsx)("div",{className:"react-chatbot-kit-bot-avatar",children:(0,c.jsx)("div",{className:"react-chatbot-kit-user-avatar-container",children:(0,c.jsx)(i,{className:"react-chatbot-kit-user-avatar-icon"})})}),{__}=wp.i18n,u=(e,t,a,r,s,o,i,u,d,m)=>({botName:r,lang:"en",initialMessages:[(0,n.createChatBotMessage)(`Hello! I am ${r}. How can I help you today? (Using ${a})`)],state:{instanceId:e,initialPrompt:t,selectedModel:a,ajaxUrl:s,nonce:o,isBlock:u,isShortcode:d,isElementor:m,chatbotName:r,...i},customComponents:{header:()=>(0,c.jsxs)("div",{className:"react-chatbot-kit-chat-header",children:["Conversation with ",r]}),botAvatar:e=>(0,c.jsx)(l,{...e})},customStyles:{}}),d=class{constructor(e,t){this.actionProvider=e,this.state=t||{}}parse(e){if(""!==e.trim()){let t="";try{const a=document.querySelector("[data-eace-current-instance]");a&&(t=a.getAttribute("data-eace-current-instance")),!t&&this.state&&this.state.instanceId&&(t=this.state.instanceId);const r=this.state||{};t&&(r.instanceId=t),this.actionProvider.handleUserMessage(e,r)}catch(a){console.error("Critical error in message processing:",a),this.actionProvider.handleUserMessage(e,{instanceId:t})}}}},{__:m}=wp.i18n,h=class{constructor(e,t,a){this.createChatBotMessage=e,this.setState=t,this.createClientMessage=a}handleUserMessage=async(e,t)=>{const a=this.getAppropriateInstance(t);if(!a)return;const{instanceId:r,selectedModel:n,initialPrompt:s,ajaxUrl:o,nonce:i}=a;this.showLoadingIndicator();const c=this.formatConversationHistory(t),l={action:"simple_ai_chat_embed_send_message",_ajax_nonce:i,message:e,instanceId:r,selectedModel:n,initialPrompt:s,conversationHistory:JSON.stringify(c)};try{const e=await this.sendApiRequest(o,l);this.handleApiResponse(e)}catch(e){this.handleApiError(e)}};getAppropriateInstance=e=>{let t="";e&&e.instanceId&&(t=e.instanceId);const a=window.easyAiChatInstances||{};if(0===Object.keys(a).length){console.error("Error: No chat instances found in global storage");const e=this.createChatBotMessage(m("I'm unable to process your request at this time. Please try again later.","easy-ai-chat-embed"));return this.addMessageToState(e),null}let r=null;return r=t&&a[t]?a[t]:a[Object.keys(a)[0]],r};showLoadingIndicator=()=>{const e=this.createChatBotMessage("Thinking...");this.addMessageToState(e)};formatConversationHistory=e=>{let t=[];return e&&Array.isArray(e.messages)&&(t=e.messages.map((e=>({type:e.type,message:e.message})))),t};sendApiRequest=async(e,t)=>{const a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t).toString()});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);return await a.json()};handleApiResponse=e=>{if(this.removeLastMessage(),e.success&&e.data.message){const t=this.createChatBotMessage(e.data.message);this.addMessageToState(t)}else{console.error("API Error:",e.data?.message||"Unknown error");const t=this.createChatBotMessage(m("Sorry, I encountered a problem processing your request. Please try again later.","easy-ai-chat-embed"));this.addMessageToState(t)}};handleApiError=e=>{console.error("Error calling backend API:",e),this.removeLastMessage();const t=this.createChatBotMessage(m("Sorry, I was unable to connect to the AI service. Please try again later.","easy-ai-chat-embed"));this.addMessageToState(t)};addMessageToState=e=>{this.setState((t=>({...t,messages:[...t.messages,e]})))};removeLastMessage=()=>{this.setState((e=>({...e,messages:e.messages.slice(0,-1)})))}},{__:g}=wp.i18n,p=wp.domReady,{createRoot:f,render:v}=wp.element;window.easyAiChatInstances=window.easyAiChatInstances||{},p((()=>{const e=document.querySelectorAll(".easy-ai-chat-embed-instance"),t="function"==typeof f,a=window.easyAiChatEmbedGlobalData;if(!a)return console.error("Simple AI Chat Embed: Global data object missing. Assets might not have been enqueued correctly."),void e.forEach((e=>{e.innerHTML.includes("noscript")||(e.innerHTML="<p>Error: Chatbot global data missing.</p>")}));e.forEach((e=>{const r=e.dataset.instanceId,s=e.dataset.selectedModel,o=e.dataset.initialPrompt,i=e.dataset.chatbotName||"AIChatBot",c="true"===e.dataset.isBlock,l="true"===e.dataset.isShortcode,m="true"===e.dataset.isElementor,g=a.ajaxUrl,p=a.nonce;if(!(r&&s&&g&&p&&i))return console.error("Simple AI Chat Embed: Missing required data for instance."),void(e.querySelector("noscript")||(e.innerHTML="<p>Error: Chatbot configuration missing or incomplete.</p>"));window.easyAiChatInstances[r]={ajaxUrl:g,nonce:p,instanceId:r,selectedModel:s,initialPrompt:o,chatbotName:i},e.setAttribute("data-eace-current-instance",r);const y={messages:[],instanceId:r,selectedModel:s,initialPrompt:o,chatbotName:i};try{const a={config:u(r,o,s,i,g,p,y,c,l,m),messageParser:d,actionProvider:h},b=e.querySelector("noscript");b&&b.remove(),e.innerHTML="";const w=wp.element.createElement("div",{className:"easy-ai-chat-widget-container"},wp.element.createElement(n.Chatbot,a));t?f(e).render(w):v(w,e)}catch(t){console.error("Error initializing chatbot:",t),e.innerHTML="<p>Error initializing chat interface. Please try again later.</p>"}}))}));const y=window.wp.blocks,b=window.wp.i18n,w=window.wp.blockEditor,E=window.wp.components,S=window.wp.element,P=[{label:(0,b.__)("Select a Model","easy-ai-chat-embed"),value:""},{label:"ChatGPT 4.0",value:"gpt-4o-mini"},{label:"Claude Sonnet 3.7",value:"claude-3-7-sonnet-20250219"},{label:"Google Gemini",value:"gemini-2.0-flash-lite"}],M=JSON.parse('{"UU":"easy-ai-chat-embed/chat-embed"}');(0,y.registerBlockType)(M.UU,{edit:function({attributes:e,setAttributes:t,clientId:a}){const r=(0,w.useBlockProps)(),{selectedModel:n,initialPrompt:s,chatbotName:o,instanceId:i}=e;return(0,S.useEffect)((()=>{i||t({instanceId:`eace-${a}`})}),[a,i,t]),(0,c.jsxs)("div",{...r,children:[(0,c.jsx)(w.InspectorControls,{children:(0,c.jsxs)(E.PanelBody,{title:(0,b.__)("AI Model Settings","easy-ai-chat-embed"),children:[(0,c.jsx)(E.SelectControl,{label:(0,b.__)("Select AI Model","easy-ai-chat-embed"),value:n,options:P,onChange:e=>t({selectedModel:e})}),(0,c.jsx)(E.TextareaControl,{label:(0,b.__)("Initial System Prompt","easy-ai-chat-embed"),help:(0,b.__)("Optional text prepended to every user prompt to guide the AI.","easy-ai-chat-embed"),value:s,onChange:e=>t({initialPrompt:e})}),(0,c.jsx)(E.TextControl,{label:(0,b.__)("Chatbot Name","easy-ai-chat-embed"),help:(0,b.__)("Optional name for this specific chat instance. Leave blank to use the default.","easy-ai-chat-embed"),value:o,onChange:e=>t({chatbotName:e})})]})}),(0,c.jsx)("p",{children:(0,b.__)("AI Chat Embed Placeholder - Configure in sidebar.","easy-ai-chat-embed")})]})},save:function({attributes:e}){const t=w.useBlockProps.save(),{selectedModel:a,initialPrompt:r,instanceId:n}=e,s=(t.className?t.className+" ":"")+"easy-ai-chat-embed-instance";return(0,c.jsx)("div",{...t,className:s,"data-selected-model":a,"data-initial-prompt":r,"data-instance-id":n,children:(0,c.jsx)("noscript",{children:(0,b.__)("Please enable JavaScript to use the AI Chat.","easy-ai-chat-embed")})})}})}},a={};function r(e){var n=a[e];if(void 0!==n)return n.exports;var s=a[e]={exports:{}};return t[e](s,s.exports,r),s.exports}r.m=t,e=[],r.O=(t,a,n,s)=>{if(!a){var o=1/0;for(u=0;u<e.length;u++){for(var[a,n,s]=e[u],i=!0,c=0;c<a.length;c++)(!1&s||o>=s)&&Object.keys(r.O).every((e=>r.O[e](a[c])))?a.splice(c--,1):(i=!1,s<o&&(o=s));if(i){e.splice(u--,1);var l=n();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[a,n,s]},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var n,s,[o,i,c]=a,l=0;if(o.some((t=>0!==e[t]))){for(n in i)r.o(i,n)&&(r.m[n]=i[n]);if(c)var u=c(r)}for(t&&t(a);l<o.length;l++)s=o[l],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(u)},a=globalThis.webpackChunksimple_ai_chat_embed=globalThis.webpackChunksimple_ai_chat_embed||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var n=r.O(void 0,[350],(()=>r(614)));n=r.O(n)})();